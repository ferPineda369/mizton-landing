<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Funci√≥n Copiar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-light">
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-clipboard"></i> Test Funci√≥n Copiar</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">CLABE Bancaria:</label>
                            <div class="input-group">
                                <input type="text" class="form-control" value="012180015545193401" readonly id="clabeInput">
                                <button class="btn btn-outline-success" type="button" onclick="copyToClipboard('clabeInput')">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Concepto:</label>
                            <div class="input-group">
                                <input type="text" class="form-control" value="Apoyo a Pahuata 2226536090" readonly id="conceptoInput">
                                <button class="btn btn-outline-warning" type="button" onclick="copyToClipboard('conceptoInput')">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="alert alert-info">
                            <h6><i class="fas fa-info-circle"></i> Instrucciones:</h6>
                            <ul class="mb-0">
                                <li>Haz clic en los botones de copiar</li>
                                <li>Verifica en la consola del navegador (F12)</li>
                                <li>Pega en un editor de texto para confirmar</li>
                                <li>El bot√≥n deber√≠a cambiar a verde con "‚úì Copiado"</li>
                            </ul>
                        </div>
                        
                        <div class="alert alert-warning">
                            <h6><i class="fas fa-exclamation-triangle"></i> Notas:</h6>
                            <ul class="mb-0">
                                <li><strong>HTTPS requerido:</strong> La API moderna solo funciona en sitios seguros</li>
                                <li><strong>Fallback incluido:</strong> Si falla, usa m√©todo antiguo</li>
                                <li><strong>√öltima opci√≥n:</strong> Selecciona texto manualmente</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Funci√≥n para copiar al portapapeles (API moderna)
        async function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const textToCopy = element.value;
            
            console.log('üöÄ Intentando copiar:', textToCopy);
            console.log('üîí Contexto seguro:', window.isSecureContext);
            console.log('üìã API disponible:', !!navigator.clipboard);
            
            try {
                // Intentar usar la API moderna del portapapeles
                if (navigator.clipboard && window.isSecureContext) {
                    await navigator.clipboard.writeText(textToCopy);
                    console.log('‚úÖ Copiado con navigator.clipboard');
                } else {
                    // Fallback para navegadores m√°s antiguos
                    element.select();
                    element.setSelectionRange(0, 99999);
                    document.execCommand('copy');
                    console.log('‚úÖ Copiado con execCommand (fallback)');
                }
                
                // Mostrar feedback visual
                const button = element.nextElementSibling || element.parentElement.querySelector('button');
                if (button) {
                    const originalHTML = button.innerHTML;
                    const originalClasses = button.className;
                    
                    button.innerHTML = '<i class="fas fa-check"></i> Copiado';
                    button.className = 'btn btn-success';
                    
                    setTimeout(() => {
                        button.innerHTML = originalHTML;
                        button.className = originalClasses;
                    }, 2000);
                }
                
            } catch (err) {
                console.error('‚ùå Error al copiar:', err);
                
                // Mostrar error visual
                const button = element.nextElementSibling || element.parentElement.querySelector('button');
                if (button) {
                    const originalHTML = button.innerHTML;
                    const originalClasses = button.className;
                    
                    button.innerHTML = '<i class="fas fa-times"></i> Error';
                    button.className = 'btn btn-danger';
                    
                    setTimeout(() => {
                        button.innerHTML = originalHTML;
                        button.className = originalClasses;
                    }, 2000);
                }
                
                // Fallback manual: seleccionar texto para que el usuario pueda copiarlo
                element.select();
                element.setSelectionRange(0, 99999);
                alert('No se pudo copiar autom√°ticamente. El texto est√° seleccionado, usa Ctrl+C para copiarlo.');
            }
        }
    </script>
</body>
</html>
